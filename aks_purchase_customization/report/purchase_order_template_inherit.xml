<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="purchase.report_purchaseorder_document">
        <t t-call="web.basic_layout">
            <!--<t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)"/>
            <t t-set="address">
                <div t-field="o.partner_id"
                t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}'/>
                <p t-if="o.partner_id.vat"><t t-esc="o.company_id.account_fiscal_country_id.vat_label or 'Tax ID'"/>: <span t-field="o.partner_id.vat"/></p>
            </t>
            <t t-if="o.dest_address_id">
                <t t-set="information_block">
                    <strong>Shipping address:</strong>
                    <div t-if="o.dest_address_id">
                        <div t-field="o.dest_address_id"
                            t-options='{"widget": "contact", "fields": ["address", "name", "phone"], "no_marker": True, "phone_icons": True}' name="purchase_shipping_address"/>
                    </div>

                </t>
            </t>-->

            <t t-set="o" t-value="o.with_context(lang=o.partner_id.lang)" style="display:none !important;"/>
            <div class="header">
                <table width="100%">
                    <tr>
                        <td>
                            <img t-if="o.company_id.logo" t-att-src="image_data_uri(o.company_id.logo)" alt="Logo"
                                 height='108'
                                 width='320'/>
                        </td>
                        <td class="text-right">
                            <strong>Purchase Order -
                                <span t-field="o.name"/>
                            </strong>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="page" style="margin-top:20px;margin-right:40px;margin-left:40px !important;">
                <div class="oe_structure"/>
                <table width="100%">
                    <tr>
                        <td>
                            <p t-if="o.partner_id.parent_id" class="m-0" t-field="o.partner_id.parent_id.name"/>
                        </td>
                        <td t-if="o.date" class="text-right">
                            <span>
                                <strong>Date:</strong>
                            </span>
                            <span class="m-0" t-field="o.date" t-options="{&quot;format&quot;: &quot;dd/mm/yyyy&quot;}"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <p t-if="o.partner_id" class="m-0" t-field="o.partner_id.name"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div t-field="o.partner_id"
                                 t-options='{"widget": "contact", "fields": ["address"], "no_marker": True}'/>
                        </td>
                    </tr>
                </table>

                <br></br>
                <table>
                    <tr>
                        <td>
                            <span>
                                <strong>Job:</strong>
                            </span>
                            <span class="m-0" t-field="o.job_number"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span>
                                <strong>Account Manager:</strong>
                            </span>
                            <span class="m-0" t-field="o.office_finance_manager.name"/>
                        </td>
                    </tr>
                </table>

                <br></br>
                <table>
                    <tr>
                        <td>
                            <span><strong>Subject:</strong></span>
                            <span t-field="o.subject"/>
                        </td>
                    </tr>
                </table>

                <!--<div class="container">
                    <div class="row"
                         style="background : #bfbfbf;color:#000;vertical-align: middle;height:30px;">
                        <div class="text-left col-auto col-6">
                            <b>Item</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Qty.</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Unit</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Price</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Total</b>
                        </div>
                    </div>
                    <t t-set="current_subtotal" t-value="0"/>
                    <t t-foreach="o.order_line" t-as="line">
                        <div class="row"
                             style="font-size:13.5px;">
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"
                               groups="account.group_show_line_subtotals_tax_excluded"/>
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total"
                               groups="account.group_show_line_subtotals_tax_included"/>
                            <t t-if="not line.display_type">
                                &lt;!&ndash;<div>
                                    <span style="padding-left:20px;" t-esc="sl_no"/>
                                    <t t-set="sl_no" t-value="sl_no + 1"/>
                                </div>&ndash;&gt;

                                <div class="col-auto col-6 text-justify">
                                    <p>
                                        <span style="display: block;" t-field="line.name"/>
                                    </p>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-esc="line.product_uom_qty"/>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-field="line.product_uom.name"/>&lt;!&ndash;groups="uom.group_uom"&ndash;&gt;
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-field="line.price_unit"/>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-field="line.price_subtotal"
                                          groups="account.group_show_line_subtotals_tax_excluded"/>
                                    <span t-field="line.price_total"
                                          groups="account.group_show_line_subtotals_tax_included"/>
                                </div>
                            </t>
                        </div>

                        <t t-if="line.display_type == 'line_note'">
                            <div class="row text-left">
                                <p style="width: 100%;font-weight:bold;" t-field="line.name"/>
                            </div>

                        </t>
                        <t t-if="line.display_type == 'line_section'">

                            <div class="row" style="background : #EA383E;color:#FFF;text-align: center;">
                                <p style="width: 100%;font-weight:bold;" t-field="line.name"/>
                            </div>

                            <t t-set="current_section" t-value="line"/>
                            <t t-set="current_subtotal" t-value="0"/>
                        </t>
                        <t t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                            <div class="row text-center" style="background : #EA383E;color:#FFF;">
                                <p style="width: 100%;">
                                    <i>
                                        <u>
                                            <strong>
                                                <span class="mr16">Total price for this offer is</span>
                                                <span t-esc="'{0:,.2f}'.format(current_subtotal)"/>
                                                <span t-esc="o.currency_id.currency_unit_label"/>
                                                Only
                                                <br/>
                                                <span style="text-align:center;"
                                                      t-esc="o.currency_id.amount_to_text(current_subtotal).upper()"/>
                                                ONLY
                                            </strong>
                                        </u>
                                    </i>
                                </p>
                            </div>
                        </t>
                    </t>
                </div>-->

                <div class="container">
                    <div class="row"
                         style="background : #bfbfbf;color:#000;vertical-align: middle;height:30px;">
                        <div class="text-left col-auto col-6">
                            <b>Item</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Qty.</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Unit</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Price</b>
                        </div>
                        <div class="text-right col-auto col-2">
                            <b>Total</b>
                        </div>
                    </div>
                    <t t-set="current_subtotal" t-value="0"/>
                    <t t-foreach="o.order_line" t-as="line">
                        <div class="row"
                             style="font-size:13.5px;">
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal"
                               groups="account.group_show_line_subtotals_tax_excluded"/>
                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total"
                               groups="account.group_show_line_subtotals_tax_included"/>
                            <t t-if="not line.display_type">
                                <div class="col-auto col-6 text-justify">
                                    <p>
                                        <span style="display: block;" t-field="line.name"/>
                                    </p>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-esc="line.product_uom_qty"/>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-field="line.product_uom" groups="uom.group_uom"/>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-field="line.price_unit"/>
                                </div>
                                <div class="text-right col-auto col-2">
                                    <span t-field="line.price_subtotal"
                                          groups="account.group_show_line_subtotals_tax_excluded"/>
                                    <span t-field="line.price_total"
                                          groups="account.group_show_line_subtotals_tax_included"/>
                                </div>
                            </t>
                        </div>

                        <t t-if="line.display_type == 'line_note'">
                            <div class="row text-left">
                                <p style="width: 100%;font-weight:bold;" t-field="line.name"/>
                            </div>
                        </t>
                        <t t-if="line.display_type == 'line_section'">
                            <strong class="row">
                                <p style="width: 100%;font-weight:bold;" t-field="line.name"/>
                            </strong>
                            <t t-set="current_section" t-value="line"/>
                            <t t-set="current_subtotal" t-value="0"/>
                        </t>
                        <t t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                            <div width="100%" style="border:1px solid black;" class="row">
                                <span style="font-weight:bold;" class="mr16">Total
                                    <t style="font-weight:bold;" t-esc="current_section.name"/>
                                </span>
                                <span class="text-right" t-esc="current_subtotal" digits="[42, 2]"
                                      t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                            </div>
                        </t>
                    </t>
                </div>
                <br/>
                <div id="total" class="row justify-content-end">
                    <!--<span style="font-weight:bold;" class="mr16">Total excl. VAT </span>-->
                    <div class="col-12">
                        <span style="font-weight:bold;" class="mr16">Total excl. VAT </span>
                        <!--<span t-field="o.tax_totals_json"/>-->
                        <table class="table table-sm">
                            <t t-set="tax_totals" t-value="json.loads(o.tax_totals_json)"/>
                            <t t-call="account.document_tax_totals"/>
                        </table>
                    </div>
                </div>

                <div class="col-8 text-left" style="margin-top:20px;margin-right:0px;margin-left:0px !important;">
                    <table width="100%">
                        <colgroup>
                        <col width='34%'/>
                        <col width='2%'/>
                        <col width='64%'/>
                    </colgroup>
                        <tr>
                            <td>
                                <span>Delivery Date:</span>
                            </td>
                            <td/>
                            <td>
                                <span t-field="o.delivery_date"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <span>Delivery Place:</span>
                            </td>
                            <td/>
                            <td>
                                <span t-field="o.delivery_place"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <span>Payment conditions:</span>
                            </td>
                            <td/>
                            <td>
                                <span t-field="o.payment_term_id"/>
                            </td>
                        </tr>
                    </table>
                </div>
                <br/>

                <div class="row text-left justify-content-end" style="margin-top:20px;margin-right:5px;margin-left:5px !important;">
                    <p t-field="o.dynamic_content"/>
                </div>

                <div class="oe_structure"/>
            </div>
        </t>
    </template>
</odoo>